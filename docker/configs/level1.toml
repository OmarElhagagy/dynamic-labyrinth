# =============================================================================
# Dynamic Labyrinth - Honeytrap Level 1 Configuration
# =============================================================================
# Low-interaction honeypot configuration
# Services: SSH, HTTP, Telnet
# =============================================================================

# -----------------------------------------------------------------------------
# Listener Configuration
# -----------------------------------------------------------------------------
[listener]
type = "socket"
addresses = ["0.0.0.0:22", "0.0.0.0:23", "0.0.0.0:80"]

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
[[logging]]
output = "stdout"
level = "info"

[[logging]]
output = "/logs/honeytrap.log"
level = "debug"

# -----------------------------------------------------------------------------
# Channel: File Pusher (for event logging)
# -----------------------------------------------------------------------------
[channel.file]
type = "file"
filename = "/logs/events.jsonl"

# -----------------------------------------------------------------------------
# Channel: Console (for debugging)
# -----------------------------------------------------------------------------
[channel.console]
type = "console"

# -----------------------------------------------------------------------------
# SSH Service - Low Interaction (using ssh-auth for simple auth capture)
# -----------------------------------------------------------------------------
[service.ssh]
type = "ssh-auth"

# -----------------------------------------------------------------------------
# HTTP Service - Low Interaction
# -----------------------------------------------------------------------------
[service.http]
type = "http"

# -----------------------------------------------------------------------------
# Telnet Service - Low Interaction
# -----------------------------------------------------------------------------
[service.telnet]
type = "telnet"

# -----------------------------------------------------------------------------
# Filters
# -----------------------------------------------------------------------------
[[filter]]
channel = ["file", "console"]

# -----------------------------------------------------------------------------
# Port Mappings (new format - services are attached to ports)
# -----------------------------------------------------------------------------
[[port]]
port = "tcp/22"
services = ["ssh"]

[[port]]
port = "tcp/23"
services = ["telnet"]

[[port]]
port = "tcp/80"
services = ["http"]
