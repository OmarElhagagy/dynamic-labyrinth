# =============================================================================
# Dynamic Labyrinth - Honeytrap Level 2 Configuration
# =============================================================================
# Medium-interaction honeypot configuration
# Services: SSH, HTTP, Telnet, FTP, SMTP, DNS
# =============================================================================

# -----------------------------------------------------------------------------
# Listener Configuration
# -----------------------------------------------------------------------------
[listener]
type = "socket"
addresses = ["0.0.0.0:21", "0.0.0.0:22", "0.0.0.0:23", "0.0.0.0:25", "0.0.0.0:53", "0.0.0.0:80"]

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
[[logging]]
output = "stdout"
level = "info"

[[logging]]
output = "/logs/honeytrap.log"
level = "debug"

# -----------------------------------------------------------------------------
# Channel: File Pusher (for event logging)
# -----------------------------------------------------------------------------
[channel.file]
type = "file"
filename = "/logs/events.jsonl"

# -----------------------------------------------------------------------------
# Channel: Console
# -----------------------------------------------------------------------------
[channel.console]
type = "console"

# -----------------------------------------------------------------------------
# SSH Service - Medium Interaction (simulator provides more interaction)
# -----------------------------------------------------------------------------
[service.ssh]
type = "ssh-simulator"

# -----------------------------------------------------------------------------
# HTTP Service - Medium Interaction
# -----------------------------------------------------------------------------
[service.http]
type = "http"

# -----------------------------------------------------------------------------
# Telnet Service - Medium Interaction
# -----------------------------------------------------------------------------
[service.telnet]
type = "telnet"

# -----------------------------------------------------------------------------
# FTP Service - Medium Interaction
# -----------------------------------------------------------------------------
[service.ftp]
type = "ftp"

# -----------------------------------------------------------------------------
# SMTP Service - Medium Interaction
# -----------------------------------------------------------------------------
[service.smtp]
type = "smtp"

# -----------------------------------------------------------------------------
# DNS Service - Medium Interaction
# -----------------------------------------------------------------------------
[service.dns]
type = "dns"

# -----------------------------------------------------------------------------
# Filters
# -----------------------------------------------------------------------------
[[filter]]
channel = ["file", "console"]

# -----------------------------------------------------------------------------
# Port Mappings
# -----------------------------------------------------------------------------
[[port]]
port = "tcp/21"
services = ["ftp"]

[[port]]
port = "tcp/22"
services = ["ssh"]

[[port]]
port = "tcp/23"
services = ["telnet"]

[[port]]
port = "tcp/25"
services = ["smtp"]

[[port]]
port = "udp/53"
services = ["dns"]

[[port]]
port = "tcp/80"
services = ["http"]
